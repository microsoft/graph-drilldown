{"remainingRequest":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\babel-loader-virtual-fd8dd261de\\0\\cache\\babel-loader-npm-8.2.2-b4e600c2c5-df5092ef98.zip\\node_modules\\babel-loader\\lib\\index.js??ruleSet[1].rules[0].use[1]!C:\\ws\\graph-drill\\.yarn\\__virtual__\\ts-loader-virtual-aa0d54d245\\0\\cache\\ts-loader-npm-9.2.1-40e1a5908e-1f2e61905d.zip\\node_modules\\ts-loader\\index.js??ruleSet[1].rules[0].use[2]!C:\\ws\\graph-drill\\src\\components\\HierarchyBrowserPanel\\HierarchyBrowserPanel.tsx","dependencies":[{"path":"C:\\ws\\graph-drill\\src\\components\\HierarchyBrowserPanel\\HierarchyBrowserPanel.tsx","mtime":1631029334789},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\cache-loader-virtual-2fd14a2267\\0\\cache\\cache-loader-npm-4.1.0-82c3da90d8-0339778bdd.zip\\node_modules\\cache-loader\\dist\\cjs.js","mtime":456789000000},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\babel-loader-virtual-fd8dd261de\\0\\cache\\babel-loader-npm-8.2.2-b4e600c2c5-df5092ef98.zip\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\ts-loader-virtual-aa0d54d245\\0\\cache\\ts-loader-npm-9.2.1-40e1a5908e-1f2e61905d.zip\\node_modules\\ts-loader\\index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyohDQogKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4NCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4gU2VlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcHJvamVjdC4NCiAqLwppbXBvcnQgeyBST09UX0NPTU1VTklUWV9JRCB9IGZyb20gJy4uLy4uL2NvbnN0YW50cyc7CmltcG9ydCB7IHVzZUNvbW11bml0eUxpc3QsIHVzZUVudGl0eUNhbGxiYWNrLCB1c2VOZWlnaGJvckNhbGxiYWNrIH0gZnJvbSAnLi9ob29rcyc7CmltcG9ydCB7IEhpZXJhcmNoeUJyb3dzZXIgfSBmcm9tICdAZXNzZXgtanMtdG9vbGtpdC9oaWVyYXJjaHktYnJvd3Nlcic7CmltcG9ydCBSZWFjdCwgeyBtZW1vLCB1c2VNZW1vLCB1c2VDYWxsYmFjayB9IGZyb20gJ3JlYWN0JzsKaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7CmltcG9ydCB7IGZpbmROb2Rlc1RhYmxlRm9yUGFyZW50IH0gZnJvbSAnfi9hcnF1ZXJvJzsKaW1wb3J0IHsgdXNlRWRnZVRhYmxlLCB1c2VHcm91cGVkQnlDb21tdW5pdHlUYWJsZSwgdXNlR3JvdXBlZEJ5UGFyZW50VGFibGUsIHVzZUJyb3dzZXJDb2x1bW5zIH0gZnJvbSAnfi9zdGF0ZSc7CmNvbnN0IGNhcmRPdmVydmlldyA9IHsKICByb290OiB7CiAgICBib3JkZXJSYWRpdXM6ICcwcHgnCiAgfSwKICBoZWFkZXJUZXh0OiAnbWVkaXVtUGx1cycsCiAgc3ViSGVhZGVyVGV4dDogJ3hTbWFsbCcKfTsKY29uc3QgdGFibGUgPSB7CiAgaGVhZGVyVGV4dDogJ21lZGl1bScsCiAgc3ViSGVhZGVyVGV4dDogJ3hTbWFsbCcsCiAgdGFibGVJdGVtc1RleHQ6ICdzbWFsbCcKfTsKZXhwb3J0IGNvbnN0IEhpZXJhcmNoeUJyb3dzZXJQYW5lbCA9IG1lbW8oZnVuY3Rpb24gSGllcmFyY2h5QnJvd3NlclBhbmVsKCkgewogIGNvbnN0IFticm93c2VyQ29sdW1uc10gPSB1c2VCcm93c2VyQ29sdW1ucygpOwogIGNvbnN0IGJ5UGFyZW50ID0gdXNlR3JvdXBlZEJ5UGFyZW50VGFibGUoKTsKICBjb25zdCBlZGdlcyA9IHVzZUVkZ2VUYWJsZSgpOwogIGNvbnN0IGJ5Q29tbXVuaXR5ID0gdXNlR3JvdXBlZEJ5Q29tbXVuaXR5VGFibGUoKTsKICBjb25zdCBjb21tdW5pdGllcyA9IHVzZUNvbW11bml0eUxpc3QoKTsKICBjb25zdCBoYW5kbGVFbnRpdHlDYWxsYmFjayA9IHVzZUVudGl0eUNhbGxiYWNrKCk7CiAgY29uc3QgaGFuZGxlTmVpZ2hib3JDYWxsYmFjayA9IHVzZU5laWdoYm9yQ2FsbGJhY2soKTsKICBjb25zdCBhdHRyQXJyYXkgPSB1c2VNZW1vKCgpID0+IEFycmF5LmZyb20oYnJvd3NlckNvbHVtbnMpLCBbYnJvd3NlckNvbHVtbnNdKTsKICBjb25zdCBsb2FkTmVpZ2hib3JzQXN5bmMgPSB1c2VDYWxsYmFjayhwYXJhbXMgPT4gewogICAgY29uc3QgcGlkID0gZmluZFBhcmVudElkKHBhcmFtcywgY29tbXVuaXRpZXMpOwogICAgY29uc3Qgbm9kZVRhYmxlID0gZmluZE5vZGVzVGFibGVGb3JQYXJlbnQocGlkLCBieVBhcmVudCk7CiAgICByZXR1cm4gaGFuZGxlTmVpZ2hib3JDYWxsYmFjayhwYXJhbXMsIG5vZGVUYWJsZSwgZWRnZXMpOwogIH0sIFtlZGdlcywgaGFuZGxlTmVpZ2hib3JDYWxsYmFjaywgY29tbXVuaXRpZXMsIGJ5UGFyZW50XSk7CiAgY29uc3QgbG9hZEVudGl0aWVzQXN5bmMgPSB1c2VDYWxsYmFjayhwYXJhbXMgPT4gaGFuZGxlRW50aXR5Q2FsbGJhY2socGFyYW1zLCBieVBhcmVudCwgYnlDb21tdW5pdHkpLCBbYnlQYXJlbnQsIGJ5Q29tbXVuaXR5LCBoYW5kbGVFbnRpdHlDYWxsYmFja10pOwogIGNvbnN0IHNldHRpbmdzID0gdXNlTWVtbygoKSA9PiAoewogICAgdmlzaWJsZUNvbHVtbnM6IGF0dHJBcnJheSwKICAgIGNvbnRyb2xzOiB7CiAgICAgIHNob3dMZXZlbDogZmFsc2UsCiAgICAgIHNob3dGaWx0ZXI6IGZhbHNlCiAgICB9LAogICAgc3R5bGVzOiB7CiAgICAgIGNhcmRPdmVydmlldywKICAgICAgdGFibGUKICAgIH0KICB9KSwgW2F0dHJBcnJheV0pOwogIGNvbnN0IG5laWdoYm9ycyA9IHVzZU1lbW8oKCkgPT4gZWRnZXMubnVtQ29scygpID4gMCA/IGxvYWROZWlnaGJvcnNBc3luYyA6IHVuZGVmaW5lZCwgW2VkZ2VzLCBsb2FkTmVpZ2hib3JzQXN5bmNdKTsKICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChDb250YWluZXIsIG51bGwsIGNvbW11bml0aWVzLmxlbmd0aCA+IDAgPyBSZWFjdC5jcmVhdGVFbGVtZW50KEhpZXJhcmNoeUJyb3dzZXIsIHsKICAgIGNvbW11bml0aWVzOiBjb21tdW5pdGllcywKICAgIGVudGl0aWVzOiBsb2FkRW50aXRpZXNBc3luYywKICAgIG5laWdoYm9yczogbmVpZ2hib3JzLAogICAgc2V0dGluZ3M6IHNldHRpbmdzCiAgfSkgOiBudWxsKTsKfSk7IC8vIGdldCB0aGUgcmF3IGNvbW11bml0eSBpZCBmb3IgdGFibGUgZmlsdGVyaW5nLiBub3RlIHNwZWNpYWwgY2FzZSBmb3IgUm9vdAoKZnVuY3Rpb24gZmluZFBhcmVudElkKHBhcmFtcywgY29tbXVuaXRpZXMpIHsKICBpZiAoY29tbXVuaXRpZXMubGVuZ3RoID09PSAxKSB7CiAgICByZXR1cm4gUk9PVF9DT01NVU5JVFlfSUQ7CiAgfQoKICBjb25zdCBjdXJyZW50SW5kZXggPSBjb21tdW5pdGllcy5maW5kSW5kZXgoYyA9PiBjLmNvbW11bml0eUlkID09PSBwYXJhbXMuY29tbXVuaXR5SWQpOwogIGNvbnN0IHBhcmVudEluZGV4ID0gY3VycmVudEluZGV4ICsgMTsKICBjb25zdCBpZCA9IGNvbW11bml0aWVzW3BhcmVudEluZGV4XS5jb21tdW5pdHlJZDsKICByZXR1cm4gaWQgPT09ICdSb290JyA/IFJPT1RfQ09NTVVOSVRZX0lEIDogaWQ7Cn0KCmNvbnN0IENvbnRhaW5lciA9IHN0eWxlZC5kaXZgYDs="},{"version":3,"sources":["C:/ws/graph-drill/src/components/HierarchyBrowserPanel/HierarchyBrowserPanel.tsx"],"names":["ROOT_COMMUNITY_ID","useCommunityList","useEntityCallback","useNeighborCallback","HierarchyBrowser","React","memo","useMemo","useCallback","styled","findNodesTableForParent","useEdgeTable","useGroupedByCommunityTable","useGroupedByParentTable","useBrowserColumns","cardOverview","root","borderRadius","headerText","subHeaderText","table","tableItemsText","HierarchyBrowserPanel","browserColumns","byParent","edges","byCommunity","communities","handleEntityCallback","handleNeighborCallback","attrArray","Array","from","loadNeighborsAsync","params","pid","findParentId","nodeTable","loadEntitiesAsync","settings","visibleColumns","controls","showLevel","showFilter","styles","neighbors","numCols","undefined","createElement","Container","length","entities","currentIndex","findIndex","c","communityId","parentIndex","id","div"],"mappings":"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","sourcesContent":["/*!\r\n * Copyright (c) Microsoft. All rights reserved.\r\n * Licensed under the MIT license. See LICENSE file in the project.\r\n */\r\nimport { ROOT_COMMUNITY_ID } from '../../constants';\r\nimport { useCommunityList, useEntityCallback, useNeighborCallback, } from './hooks';\r\nimport { HierarchyBrowser, } from '@essex-js-toolkit/hierarchy-browser';\r\nimport React, { memo, useMemo, useCallback } from 'react';\r\nimport styled from 'styled-components';\r\nimport { findNodesTableForParent } from '~/arquero';\r\nimport { useEdgeTable, useGroupedByCommunityTable, useGroupedByParentTable, useBrowserColumns, } from '~/state';\r\nconst cardOverview = {\r\n    root: { borderRadius: '0px' },\r\n    headerText: 'mediumPlus',\r\n    subHeaderText: 'xSmall',\r\n};\r\nconst table = {\r\n    headerText: 'medium',\r\n    subHeaderText: 'xSmall',\r\n    tableItemsText: 'small',\r\n};\r\nexport const HierarchyBrowserPanel = memo(function HierarchyBrowserPanel() {\r\n    const [browserColumns] = useBrowserColumns();\r\n    const byParent = useGroupedByParentTable();\r\n    const edges = useEdgeTable();\r\n    const byCommunity = useGroupedByCommunityTable();\r\n    const communities = useCommunityList();\r\n    const handleEntityCallback = useEntityCallback();\r\n    const handleNeighborCallback = useNeighborCallback();\r\n    const attrArray = useMemo(() => Array.from(browserColumns), [browserColumns]);\r\n    const loadNeighborsAsync = useCallback((params) => {\r\n        const pid = findParentId(params, communities);\r\n        const nodeTable = findNodesTableForParent(pid, byParent);\r\n        return handleNeighborCallback(params, nodeTable, edges);\r\n    }, [edges, handleNeighborCallback, communities, byParent]);\r\n    const loadEntitiesAsync = useCallback((params) => handleEntityCallback(params, byParent, byCommunity), [byParent, byCommunity, handleEntityCallback]);\r\n    const settings = useMemo(() => ({\r\n        visibleColumns: attrArray,\r\n        controls: { showLevel: false, showFilter: false },\r\n        styles: { cardOverview, table },\r\n    }), [attrArray]);\r\n    const neighbors = useMemo(() => edges.numCols() > 0\r\n        ? loadNeighborsAsync\r\n        : undefined, [edges, loadNeighborsAsync]);\r\n    return (React.createElement(Container, null, communities.length > 0 ? (React.createElement(HierarchyBrowser, { communities: communities, entities: loadEntitiesAsync, neighbors: neighbors, settings: settings })) : null));\r\n});\r\n// get the raw community id for table filtering. note special case for Root\r\nfunction findParentId(params, communities) {\r\n    if (communities.length === 1) {\r\n        return ROOT_COMMUNITY_ID;\r\n    }\r\n    const currentIndex = communities.findIndex(c => c.communityId === params.communityId);\r\n    const parentIndex = currentIndex + 1;\r\n    const id = communities[parentIndex].communityId;\r\n    return id === 'Root' ? ROOT_COMMUNITY_ID : id;\r\n}\r\nconst Container = styled.div ``;\r\n"]}]}