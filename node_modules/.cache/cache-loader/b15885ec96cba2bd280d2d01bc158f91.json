{"remainingRequest":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\babel-loader-virtual-fd8dd261de\\0\\cache\\babel-loader-npm-8.2.2-b4e600c2c5-df5092ef98.zip\\node_modules\\babel-loader\\lib\\index.js??ruleSet[1].rules[0].use[1]!C:\\ws\\graph-drill\\.yarn\\__virtual__\\ts-loader-virtual-aa0d54d245\\0\\cache\\ts-loader-npm-9.2.1-40e1a5908e-1f2e61905d.zip\\node_modules\\ts-loader\\index.js??ruleSet[1].rules[0].use[2]!C:\\ws\\graph-drill\\src\\state\\vis\\edgeOpacity.ts","dependencies":[{"path":"C:\\ws\\graph-drill\\src\\state\\vis\\edgeOpacity.ts","mtime":1631029334906},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\cache-loader-virtual-2fd14a2267\\0\\cache\\cache-loader-npm-4.1.0-82c3da90d8-0339778bdd.zip\\node_modules\\cache-loader\\dist\\cjs.js","mtime":456789000000},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\babel-loader-virtual-fd8dd261de\\0\\cache\\babel-loader-npm-8.2.2-b4e600c2c5-df5092ef98.zip\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\ts-loader-virtual-aa0d54d245\\0\\cache\\ts-loader-npm-9.2.1-40e1a5908e-1f2e61905d.zip\\node_modules\\ts-loader\\index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgeyBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IH0ga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CgppbXBvcnQgeyBlZGdlVGFibGVTdGF0ZSB9IGZyb20gJy4uL3RhYmxlcyc7CmltcG9ydCB7IGdldERlZmF1bHROdW1lcmljT3B0aW9ucyB9IGZyb20gJy4vY29uZmlnJzsKaW1wb3J0IHsgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7CmltcG9ydCB7IGF0b20sIGF0b21GYW1pbHksIHNlbGVjdG9yRmFtaWx5LCB1c2VSZWNvaWxWYWx1ZSwgdXNlU2V0UmVjb2lsU3RhdGUgfSBmcm9tICdyZWNvaWwnOwppbXBvcnQgeyBnZXRDb2x1bW5TdGF0cyB9IGZyb20gJ34vYXJxdWVybyc7CmNvbnN0IGZpZWxkU3RhdGUgPSBhdG9tKHsKICBrZXk6ICdlZGdlLW9wYWNpdHktZW5jb2RpbmctZmllbGQnLAogIGRlZmF1bHQ6ICcnCn0pOwpjb25zdCBlbmNvZGluZ1N0YXRlID0gYXRvbUZhbWlseSh7CiAga2V5OiAnZWRnZS1vcGFjaXR5LWVuY29kaW5nLXN0YXRlJywKICBkZWZhdWx0OiBzZWxlY3RvckZhbWlseSh7CiAgICBrZXk6ICdlZGdlLW9wYWNpdHktZW5jb2Rpbmctc3RhdGUtZGVmYXVsdCcsCiAgICBnZXQ6IGZpZWxkID0+ICh7CiAgICAgIGdldAogICAgfSkgPT4gewogICAgICAvLyBUT0RPOiBmaWx0ZXIgYnkgcGFyZW50CiAgICAgIGNvbnN0IHRhYmxlID0gZ2V0KGVkZ2VUYWJsZVN0YXRlKTsKICAgICAgY29uc3Qgc3RhdHMgPSBnZXRDb2x1bW5TdGF0cyh0YWJsZSwgZmllbGQpOwogICAgICByZXR1cm4gZ2V0RGVmYXVsdEVkZ2VPcGFjaXR5T3B0aW9ucyhmaWVsZCwgc3RhdHMpOwogICAgfQogIH0pCn0pOwpleHBvcnQgZnVuY3Rpb24gdXNlRWRnZU9wYWNpdHlFbmNvZGluZygpIHsKICBjb25zdCBmaWVsZCA9IHVzZVJlY29pbFZhbHVlKGZpZWxkU3RhdGUpOwogIHJldHVybiB1c2VSZWNvaWxWYWx1ZShlbmNvZGluZ1N0YXRlKGZpZWxkKSk7Cn0KZXhwb3J0IGZ1bmN0aW9uIHVzZVVwZGF0ZUVkZ2VPcGFjaXR5RW5jb2RpbmcoKSB7CiAgY29uc3QgZW5jb2RpbmcgPSB1c2VFZGdlT3BhY2l0eUVuY29kaW5nKCk7CiAgY29uc3Qgc2V0dGVyID0gdXNlU2V0UmVjb2lsU3RhdGUoZW5jb2RpbmdTdGF0ZShlbmNvZGluZy5maWVsZCB8fCAnJykpOwogIGNvbnN0IGZpZWxkU2V0dGVyID0gdXNlU2V0UmVjb2lsU3RhdGUoZmllbGRTdGF0ZSk7CiAgcmV0dXJuIHVzZUNhbGxiYWNrKHVwZGF0ZSA9PiB7CiAgICBpZiAodXBkYXRlLmZpZWxkKSB7CiAgICAgIGZpZWxkU2V0dGVyKHVwZGF0ZS5maWVsZCk7CiAgICB9IGVsc2UgewogICAgICBzZXR0ZXIoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBlbmNvZGluZyksIHVwZGF0ZSkpOwogICAgfQogIH0sIFtlbmNvZGluZywgc2V0dGVyLCBmaWVsZFNldHRlcl0pOwp9CgpmdW5jdGlvbiBnZXREZWZhdWx0RWRnZU9wYWNpdHlPcHRpb25zKGZpZWxkLCBzdGF0cykgewogIHJldHVybiBnZXREZWZhdWx0TnVtZXJpY09wdGlvbnMoZmllbGQsIHN0YXRzLCB7CiAgICB2YWx1ZTogMC4yLAogICAgcmFuZ2U6IFswLjEsIDFdCiAgfSk7Cn0="},{"version":3,"sources":["C:/ws/graph-drill/src/state/vis/edgeOpacity.ts"],"names":["edgeTableState","getDefaultNumericOptions","useCallback","atom","atomFamily","selectorFamily","useRecoilValue","useSetRecoilState","getColumnStats","fieldState","key","default","encodingState","get","field","table","stats","getDefaultEdgeOpacityOptions","useEdgeOpacityEncoding","useUpdateEdgeOpacityEncoding","encoding","setter","fieldSetter","update","value","range"],"mappings":";;;;;;AAAA,SAASA,cAAT,QAA+B,WAA/B;AACA,SAASC,wBAAT,QAAyC,UAAzC;AACA,SAASC,WAAT,QAA4B,OAA5B;AACA,SAASC,IAAT,EAAeC,UAAf,EAA2BC,cAA3B,EAA2CC,cAA3C,EAA2DC,iBAA3D,QAAqF,QAArF;AACA,SAASC,cAAT,QAA+B,WAA/B;AACA,MAAMC,UAAU,GAAGN,IAAI,CAAC;AACpBO,EAAAA,GAAG,EAAE,6BADe;AAEpBC,EAAAA,OAAO,EAAE;AAFW,CAAD,CAAvB;AAIA,MAAMC,aAAa,GAAGR,UAAU,CAAC;AAC7BM,EAAAA,GAAG,EAAE,6BADwB;AAE7BC,EAAAA,OAAO,EAAEN,cAAc,CAAC;AACpBK,IAAAA,GAAG,EAAE,qCADe;AAEpBG,IAAAA,GAAG,EAAGC,KAAD,IAAW,CAAC;AAAED,MAAAA;AAAF,KAAD,KAAa;AACzB;AACA,YAAME,KAAK,GAAGF,GAAG,CAACb,cAAD,CAAjB;AACA,YAAMgB,KAAK,GAAGR,cAAc,CAACO,KAAD,EAAQD,KAAR,CAA5B;AACA,aAAOG,4BAA4B,CAACH,KAAD,EAAQE,KAAR,CAAnC;AACH;AAPmB,GAAD;AAFM,CAAD,CAAhC;AAYA,OAAO,SAASE,sBAAT,GAAkC;AACrC,QAAMJ,KAAK,GAAGR,cAAc,CAACG,UAAD,CAA5B;AACA,SAAOH,cAAc,CAACM,aAAa,CAACE,KAAD,CAAd,CAArB;AACH;AACD,OAAO,SAASK,4BAAT,GAAwC;AAC3C,QAAMC,QAAQ,GAAGF,sBAAsB,EAAvC;AACA,QAAMG,MAAM,GAAGd,iBAAiB,CAACK,aAAa,CAACQ,QAAQ,CAACN,KAAT,IAAkB,EAAnB,CAAd,CAAhC;AACA,QAAMQ,WAAW,GAAGf,iBAAiB,CAACE,UAAD,CAArC;AACA,SAAOP,WAAW,CAAEqB,MAAD,IAAY;AAC3B,QAAIA,MAAM,CAACT,KAAX,EAAkB;AACdQ,MAAAA,WAAW,CAACC,MAAM,CAACT,KAAR,CAAX;AACH,KAFD,MAGK;AACDO,MAAAA,MAAM,iCACCD,QADD,GAECG,MAFD,EAAN;AAIH;AACJ,GAViB,EAUf,CAACH,QAAD,EAAWC,MAAX,EAAmBC,WAAnB,CAVe,CAAlB;AAWH;;AACD,SAASL,4BAAT,CAAsCH,KAAtC,EAA6CE,KAA7C,EAAoD;AAChD,SAAOf,wBAAwB,CAACa,KAAD,EAAQE,KAAR,EAAe;AAC1CQ,IAAAA,KAAK,EAAE,GADmC;AAE1CC,IAAAA,KAAK,EAAE,CAAC,GAAD,EAAM,CAAN;AAFmC,GAAf,CAA/B;AAIH","sourcesContent":["import { edgeTableState } from '../tables';\r\nimport { getDefaultNumericOptions } from './config';\r\nimport { useCallback } from 'react';\r\nimport { atom, atomFamily, selectorFamily, useRecoilValue, useSetRecoilState, } from 'recoil';\r\nimport { getColumnStats } from '~/arquero';\r\nconst fieldState = atom({\r\n    key: 'edge-opacity-encoding-field',\r\n    default: '',\r\n});\r\nconst encodingState = atomFamily({\r\n    key: 'edge-opacity-encoding-state',\r\n    default: selectorFamily({\r\n        key: 'edge-opacity-encoding-state-default',\r\n        get: (field) => ({ get }) => {\r\n            // TODO: filter by parent\r\n            const table = get(edgeTableState);\r\n            const stats = getColumnStats(table, field);\r\n            return getDefaultEdgeOpacityOptions(field, stats);\r\n        },\r\n    }),\r\n});\r\nexport function useEdgeOpacityEncoding() {\r\n    const field = useRecoilValue(fieldState);\r\n    return useRecoilValue(encodingState(field));\r\n}\r\nexport function useUpdateEdgeOpacityEncoding() {\r\n    const encoding = useEdgeOpacityEncoding();\r\n    const setter = useSetRecoilState(encodingState(encoding.field || ''));\r\n    const fieldSetter = useSetRecoilState(fieldState);\r\n    return useCallback((update) => {\r\n        if (update.field) {\r\n            fieldSetter(update.field);\r\n        }\r\n        else {\r\n            setter({\r\n                ...encoding,\r\n                ...update,\r\n            });\r\n        }\r\n    }, [encoding, setter, fieldSetter]);\r\n}\r\nfunction getDefaultEdgeOpacityOptions(field, stats) {\r\n    return getDefaultNumericOptions(field, stats, {\r\n        value: 0.2,\r\n        range: [0.1, 1],\r\n    });\r\n}\r\n"]}]}