{"remainingRequest":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\babel-loader-virtual-fd8dd261de\\0\\cache\\babel-loader-npm-8.2.2-b4e600c2c5-df5092ef98.zip\\node_modules\\babel-loader\\lib\\index.js??ruleSet[1].rules[0].use[1]!C:\\ws\\graph-drill\\.yarn\\__virtual__\\ts-loader-virtual-aa0d54d245\\0\\cache\\ts-loader-npm-9.2.1-40e1a5908e-1f2e61905d.zip\\node_modules\\ts-loader\\index.js??ruleSet[1].rules[0].use[2]!C:\\ws\\graph-drill\\src\\state\\vis\\nodeColor.ts","dependencies":[{"path":"C:\\ws\\graph-drill\\src\\state\\vis\\nodeColor.ts","mtime":1631029334911},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\cache-loader-virtual-2fd14a2267\\0\\cache\\cache-loader-npm-4.1.0-82c3da90d8-0339778bdd.zip\\node_modules\\cache-loader\\dist\\cjs.js","mtime":456789000000},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\babel-loader-virtual-fd8dd261de\\0\\cache\\babel-loader-npm-8.2.2-b4e600c2c5-df5092ef98.zip\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\ts-loader-virtual-aa0d54d245\\0\\cache\\ts-loader-npm-9.2.1-40e1a5908e-1f2e61905d.zip\\node_modules\\ts-loader\\index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgeyBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IH0ga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CgppbXBvcnQgeyBzZWxlY3RlZENvbW11bml0eVN0YXRlIH0gZnJvbSAnLi4vY29tbXVuaXRpZXMnOwppbXBvcnQgeyB0aGVtZVN0YXRlIH0gZnJvbSAnLi4vc2V0dGluZ3MnOwppbXBvcnQgeyBjb21tdW5pdHlOb2Rlc1RhYmxlU3RhdGUgfSBmcm9tICcuLi90YWJsZXMnOwppbXBvcnQgeyBnZXREZWZhdWx0Q29sb3JPcHRpb25zIH0gZnJvbSAnLi9jb25maWcnOwppbXBvcnQgeyB1c2VDYWxsYmFjayB9IGZyb20gJ3JlYWN0JzsKaW1wb3J0IHsgYXRvbSwgYXRvbUZhbWlseSwgc2VsZWN0b3JGYW1pbHksIHVzZVJlY29pbFZhbHVlLCB1c2VTZXRSZWNvaWxTdGF0ZSB9IGZyb20gJ3JlY29pbCc7CmltcG9ydCB7IGdldENvbHVtblN0YXRzIH0gZnJvbSAnfi9hcnF1ZXJvJzsKY29uc3QgZmllbGRTdGF0ZSA9IGF0b20oewogIGtleTogJ25vZGUtY29sb3ItZW5jb2RpbmctZmllbGQnLAogIGRlZmF1bHQ6ICdjb21tdW5pdHkuaWQnCn0pOwpjb25zdCBlbmNvZGluZ1N0YXRlID0gYXRvbUZhbWlseSh7CiAga2V5OiAnbm9kZS1jb2xvci1lbmNvZGluZy1zdGF0ZScsCiAgZGVmYXVsdDogc2VsZWN0b3JGYW1pbHkoewogICAga2V5OiAnbm9kZS1jb2xvci1lbmNvZGluZy1zdGF0ZS1kZWZhdWx0JywKICAgIGdldDogZmllbGQgPT4gKHsKICAgICAgZ2V0CiAgICB9KSA9PiB7CiAgICAgIGNvbnN0IHBpZCA9IGdldChzZWxlY3RlZENvbW11bml0eVN0YXRlKTsKICAgICAgY29uc3QgdGFibGUgPSBnZXQoY29tbXVuaXR5Tm9kZXNUYWJsZVN0YXRlKHBpZCkpOwogICAgICBjb25zdCBzdGF0cyA9IGdldENvbHVtblN0YXRzKHRhYmxlLCBmaWVsZCk7CiAgICAgIGNvbnN0IHRoZW1lID0gZ2V0KHRoZW1lU3RhdGUpOwogICAgICByZXR1cm4gZ2V0RGVmYXVsdE5vZGVDb2xvck9wdGlvbnMoZmllbGQsIHN0YXRzLCB0aGVtZSk7CiAgICB9CiAgfSkKfSk7CmV4cG9ydCBmdW5jdGlvbiB1c2VOb2RlQ29sb3JFbmNvZGluZygpIHsKICBjb25zdCBmaWVsZCA9IHVzZVJlY29pbFZhbHVlKGZpZWxkU3RhdGUpOwogIHJldHVybiB1c2VSZWNvaWxWYWx1ZShlbmNvZGluZ1N0YXRlKGZpZWxkKSk7Cn0KZXhwb3J0IGZ1bmN0aW9uIHVzZVVwZGF0ZU5vZGVDb2xvckVuY29kaW5nKCkgewogIGNvbnN0IGVuY29kaW5nID0gdXNlTm9kZUNvbG9yRW5jb2RpbmcoKTsKICBjb25zdCBzZXR0ZXIgPSB1c2VTZXRSZWNvaWxTdGF0ZShlbmNvZGluZ1N0YXRlKGVuY29kaW5nLmZpZWxkIHx8ICcnKSk7CiAgY29uc3QgZmllbGRTZXR0ZXIgPSB1c2VTZXRSZWNvaWxTdGF0ZShmaWVsZFN0YXRlKTsKICByZXR1cm4gdXNlQ2FsbGJhY2sodXBkYXRlID0+IHsKICAgIGlmICh1cGRhdGUuZmllbGQpIHsKICAgICAgZmllbGRTZXR0ZXIodXBkYXRlLmZpZWxkKTsKICAgIH0gZWxzZSB7CiAgICAgIHNldHRlcihfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGVuY29kaW5nKSwgdXBkYXRlKSk7CiAgICB9CiAgfSwgW2VuY29kaW5nLCBzZXR0ZXIsIGZpZWxkU2V0dGVyXSk7Cn0KCmZ1bmN0aW9uIGdldERlZmF1bHROb2RlQ29sb3JPcHRpb25zKGZpZWxkLCBzdGF0cywgdGhlbWUpIHsKICByZXR1cm4gZ2V0RGVmYXVsdENvbG9yT3B0aW9ucyhmaWVsZCwgc3RhdHMsIHsKICAgIHZhbHVlOiB0aGVtZS5ub2RlKCkuZmlsbCgpLmhleCgpLAogICAgdGhlbWF0aWNTY2hlbWVQYXRoOiAnbm9taW5hbFswXScKICB9KTsKfQ=="},{"version":3,"sources":["C:/ws/graph-drill/src/state/vis/nodeColor.ts"],"names":["selectedCommunityState","themeState","communityNodesTableState","getDefaultColorOptions","useCallback","atom","atomFamily","selectorFamily","useRecoilValue","useSetRecoilState","getColumnStats","fieldState","key","default","encodingState","get","field","pid","table","stats","theme","getDefaultNodeColorOptions","useNodeColorEncoding","useUpdateNodeColorEncoding","encoding","setter","fieldSetter","update","value","node","fill","hex","thematicSchemePath"],"mappings":";;;;;;AAAA,SAASA,sBAAT,QAAuC,gBAAvC;AACA,SAASC,UAAT,QAA2B,aAA3B;AACA,SAASC,wBAAT,QAAyC,WAAzC;AACA,SAASC,sBAAT,QAAuC,UAAvC;AACA,SAASC,WAAT,QAA4B,OAA5B;AACA,SAASC,IAAT,EAAeC,UAAf,EAA2BC,cAA3B,EAA2CC,cAA3C,EAA2DC,iBAA3D,QAAqF,QAArF;AACA,SAASC,cAAT,QAA+B,WAA/B;AACA,MAAMC,UAAU,GAAGN,IAAI,CAAC;AACpBO,EAAAA,GAAG,EAAE,2BADe;AAEpBC,EAAAA,OAAO,EAAE;AAFW,CAAD,CAAvB;AAIA,MAAMC,aAAa,GAAGR,UAAU,CAAC;AAC7BM,EAAAA,GAAG,EAAE,2BADwB;AAE7BC,EAAAA,OAAO,EAAEN,cAAc,CAAC;AACpBK,IAAAA,GAAG,EAAE,mCADe;AAEpBG,IAAAA,GAAG,EAAGC,KAAD,IAAW,CAAC;AAAED,MAAAA;AAAF,KAAD,KAAa;AACzB,YAAME,GAAG,GAAGF,GAAG,CAACf,sBAAD,CAAf;AACA,YAAMkB,KAAK,GAAGH,GAAG,CAACb,wBAAwB,CAACe,GAAD,CAAzB,CAAjB;AACA,YAAME,KAAK,GAAGT,cAAc,CAACQ,KAAD,EAAQF,KAAR,CAA5B;AACA,YAAMI,KAAK,GAAGL,GAAG,CAACd,UAAD,CAAjB;AACA,aAAOoB,0BAA0B,CAACL,KAAD,EAAQG,KAAR,EAAeC,KAAf,CAAjC;AACH;AARmB,GAAD;AAFM,CAAD,CAAhC;AAaA,OAAO,SAASE,oBAAT,GAAgC;AACnC,QAAMN,KAAK,GAAGR,cAAc,CAACG,UAAD,CAA5B;AACA,SAAOH,cAAc,CAACM,aAAa,CAACE,KAAD,CAAd,CAArB;AACH;AACD,OAAO,SAASO,0BAAT,GAAsC;AACzC,QAAMC,QAAQ,GAAGF,oBAAoB,EAArC;AACA,QAAMG,MAAM,GAAGhB,iBAAiB,CAACK,aAAa,CAACU,QAAQ,CAACR,KAAT,IAAkB,EAAnB,CAAd,CAAhC;AACA,QAAMU,WAAW,GAAGjB,iBAAiB,CAACE,UAAD,CAArC;AACA,SAAOP,WAAW,CAAEuB,MAAD,IAAY;AAC3B,QAAIA,MAAM,CAACX,KAAX,EAAkB;AACdU,MAAAA,WAAW,CAACC,MAAM,CAACX,KAAR,CAAX;AACH,KAFD,MAGK;AACDS,MAAAA,MAAM,iCACCD,QADD,GAECG,MAFD,EAAN;AAIH;AACJ,GAViB,EAUf,CAACH,QAAD,EAAWC,MAAX,EAAmBC,WAAnB,CAVe,CAAlB;AAWH;;AACD,SAASL,0BAAT,CAAoCL,KAApC,EAA2CG,KAA3C,EAAkDC,KAAlD,EAAyD;AACrD,SAAOjB,sBAAsB,CAACa,KAAD,EAAQG,KAAR,EAAe;AACxCS,IAAAA,KAAK,EAAER,KAAK,CAACS,IAAN,GAAaC,IAAb,GAAoBC,GAApB,EADiC;AAExCC,IAAAA,kBAAkB,EAAE;AAFoB,GAAf,CAA7B;AAIH","sourcesContent":["import { selectedCommunityState } from '../communities';\r\nimport { themeState } from '../settings';\r\nimport { communityNodesTableState } from '../tables';\r\nimport { getDefaultColorOptions } from './config';\r\nimport { useCallback } from 'react';\r\nimport { atom, atomFamily, selectorFamily, useRecoilValue, useSetRecoilState, } from 'recoil';\r\nimport { getColumnStats } from '~/arquero';\r\nconst fieldState = atom({\r\n    key: 'node-color-encoding-field',\r\n    default: 'community.id',\r\n});\r\nconst encodingState = atomFamily({\r\n    key: 'node-color-encoding-state',\r\n    default: selectorFamily({\r\n        key: 'node-color-encoding-state-default',\r\n        get: (field) => ({ get }) => {\r\n            const pid = get(selectedCommunityState);\r\n            const table = get(communityNodesTableState(pid));\r\n            const stats = getColumnStats(table, field);\r\n            const theme = get(themeState);\r\n            return getDefaultNodeColorOptions(field, stats, theme);\r\n        },\r\n    }),\r\n});\r\nexport function useNodeColorEncoding() {\r\n    const field = useRecoilValue(fieldState);\r\n    return useRecoilValue(encodingState(field));\r\n}\r\nexport function useUpdateNodeColorEncoding() {\r\n    const encoding = useNodeColorEncoding();\r\n    const setter = useSetRecoilState(encodingState(encoding.field || ''));\r\n    const fieldSetter = useSetRecoilState(fieldState);\r\n    return useCallback((update) => {\r\n        if (update.field) {\r\n            fieldSetter(update.field);\r\n        }\r\n        else {\r\n            setter({\r\n                ...encoding,\r\n                ...update,\r\n            });\r\n        }\r\n    }, [encoding, setter, fieldSetter]);\r\n}\r\nfunction getDefaultNodeColorOptions(field, stats, theme) {\r\n    return getDefaultColorOptions(field, stats, {\r\n        value: theme.node().fill().hex(),\r\n        thematicSchemePath: 'nominal[0]',\r\n    });\r\n}\r\n"]}]}