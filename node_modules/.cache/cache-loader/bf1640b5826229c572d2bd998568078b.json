{"remainingRequest":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\babel-loader-virtual-fd8dd261de\\0\\cache\\babel-loader-npm-8.2.2-b4e600c2c5-df5092ef98.zip\\node_modules\\babel-loader\\lib\\index.js??ruleSet[1].rules[0].use[1]!C:\\ws\\graph-drill\\.yarn\\__virtual__\\ts-loader-virtual-aa0d54d245\\0\\cache\\ts-loader-npm-9.2.1-40e1a5908e-1f2e61905d.zip\\node_modules\\ts-loader\\index.js??ruleSet[1].rules[0].use[2]!C:\\ws\\graph-drill\\src\\components\\App\\pages\\GraphViewerPage\\SidePanel\\PanelComponents\\Layout.tsx","dependencies":[{"path":"C:\\ws\\graph-drill\\src\\components\\App\\pages\\GraphViewerPage\\SidePanel\\PanelComponents\\Layout.tsx","mtime":1631029334728},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\cache-loader-virtual-2fd14a2267\\0\\cache\\cache-loader-npm-4.1.0-82c3da90d8-0339778bdd.zip\\node_modules\\cache-loader\\dist\\cjs.js","mtime":456789000000},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\babel-loader-virtual-fd8dd261de\\0\\cache\\babel-loader-npm-8.2.2-b4e600c2c5-df5092ef98.zip\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\ts-loader-virtual-aa0d54d245\\0\\cache\\ts-loader-npm-9.2.1-40e1a5908e-1f2e61905d.zip\\node_modules\\ts-loader\\index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyohDQogKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4NCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4gU2VlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcHJvamVjdC4NCiAqLwppbXBvcnQgeyBVbWFwTGF5b3V0IH0gZnJvbSAnLi9VbWFwTGF5b3V0JzsKaW1wb3J0IHsgRGVmYXVsdEJ1dHRvbiwgU3Bpbm5lciwgVG9nZ2xlIH0gZnJvbSAnQGZsdWVudHVpL3JlYWN0JzsKaW1wb3J0IHsgYWxsLCBub3QgfSBmcm9tICdhcnF1ZXJvJzsKaW1wb3J0IFJlYWN0LCB7IG1lbW8sIHVzZUNhbGxiYWNrLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JzsKaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7CmltcG9ydCB7IHVzZUFycXVlcm9CaWdUYWJsZSwgdXNlQXJxdWVyb0VkZ2VUYWJsZSwgdXNlU2V0QXJxdWVyb0JpZ1RhYmxlIH0gZnJvbSAnfi9hcnF1ZXJvJzsKaW1wb3J0IHsgZXhlY3V0ZUxheW91dCwgTGF5b3V0IGFzIExheW91dFR5cGUgfSBmcm9tICd+L2xheW91dCc7CmltcG9ydCB7IHVzZUZlYXR1cmVzLCB1c2VHcmFwaFZpZXdUeXBlLCB1c2VTZXRHcmFwaFZpZXdUeXBlIH0gZnJvbSAnfi9zdGF0ZSc7CmltcG9ydCB7IFZpZXdUeXBlIH0gZnJvbSAnfi90eXBlcyc7CmV4cG9ydCBjb25zdCBMYXlvdXQgPSBtZW1vKGZ1bmN0aW9uIExheW91dCgpIHsKICBjb25zdCBub2RlcyA9IHVzZUFycXVlcm9CaWdUYWJsZSgpOwogIGNvbnN0IGVkZ2VzID0gdXNlQXJxdWVyb0VkZ2VUYWJsZSgpOwogIGNvbnN0IHNldEJpZ1RhYmxlID0gdXNlU2V0QXJxdWVyb0JpZ1RhYmxlKCk7CiAgY29uc3QgW2ZlYXR1cmVzXSA9IHVzZUZlYXR1cmVzKCk7CiAgY29uc3QgZ3JhcGhWaWV3ID0gdXNlR3JhcGhWaWV3VHlwZSgpOwogIGNvbnN0IHNldEdyYXBoVmlldyA9IHVzZVNldEdyYXBoVmlld1R5cGUoKTsKICBjb25zdCBbbG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7CiAgY29uc3QgcGVyZm9ybUxheW91dCA9IHVzZUNhbGxiYWNrKHR5cGUgPT4gewogICAgY29uc29sZS5sb2coJ3BlcmZvcm1pbmcgbGF5b3V0JywgdHlwZSk7CgogICAgY29uc3QgZmluYWxpemUgPSB0YWJsZSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKCdsYXlvdXQgY29tcGxldGUnLCB0eXBlKTsKICAgICAgdGFibGUucHJpbnQoKTsKICAgICAgY29uc3QgbWVyZ2VkID0gbm9kZXMuam9pbih0YWJsZSwgWydub2RlLmlkJywgJ25vZGUuaWQnXSwgLy8gbm90ZSB0aGF0IHdlJ3JlIG92ZXJ3cml0aW5nIGFueSBwcmV2aW91cyBjb2x1bW5zIHdpdGggYW55dGhpbmcgbmV3IGZyb20gbGF5b3V0CiAgICAgIC8vIHRoZSBmdWxsIHBpcGVsaW5lcyBvZnRlbiBpbmNsdWRlIGNvbW11bml0eS5pZCBhbmQgYSBzaXplLi4uCiAgICAgIFtub3QodGFibGUuY29sdW1uTmFtZXMoKSksIGFsbCgpXSk7CiAgICAgIG1lcmdlZC5wcmludCgpOwogICAgICBzZXRCaWdUYWJsZShtZXJnZWQpOwogICAgICBzZXRMb2FkaW5nKGZhbHNlKTsKICAgIH07CgogICAgY29uc3QgZGVkdXBlZCA9IG5vZGVzLm9yZGVyYnkoJ2NvbW11bml0eS5ub2RlQ291bnQnKS5zZWxlY3QoWydub2RlLmlkJywgJ25vZGUueCcsICdub2RlLnknXSkuZGVkdXBlKCdub2RlLmlkJykudW5ncm91cCgpOwogICAgZXhlY3V0ZUxheW91dCh0eXBlLCBkZWR1cGVkLCBlZGdlcykudGhlbihmaW5hbGl6ZSk7CiAgfSwgW25vZGVzLCBlZGdlcywgc2V0QmlnVGFibGVdKTsKICBjb25zdCBoYW5kbGVHcmlkQ2xpY2sgPSB1c2VDYWxsYmFjaygoKSA9PiB7CiAgICBzZXRMb2FkaW5nKHRydWUpOwogICAgcGVyZm9ybUxheW91dChMYXlvdXRUeXBlLkdyaWQpOwogIH0sIFtwZXJmb3JtTGF5b3V0XSk7IC8vIGNvbnN0IGhhbmRsZUZBMkNsaWNrID0gdXNlQ2FsbGJhY2soKCkgPT4gewogIC8vIAlzZXRMb2FkaW5nKHRydWUpCiAgLy8gCXBlcmZvcm1MYXlvdXQoTGF5b3V0VHlwZS5GQTIpCiAgLy8gfSwgW3BlcmZvcm1MYXlvdXRdKQoKICBjb25zdCBoYW5kbGVVbWFwQ2xpY2sgPSB1c2VDYWxsYmFjaygoKSA9PiB7CiAgICBzZXRMb2FkaW5nKHRydWUpOwogICAgcGVyZm9ybUxheW91dChMYXlvdXRUeXBlLlVNQVApOwogIH0sIFtwZXJmb3JtTGF5b3V0XSk7CiAgY29uc3QgaGFuZGxlVmlld0NoYW5nZWQgPSB1c2VDYWxsYmFjaygoZSwgdikgPT4gc2V0R3JhcGhWaWV3KHYgPyBWaWV3VHlwZS5TbWFsbE11bHRpcGxlIDogVmlld1R5cGUuU2luZ2xlR3JhcGgpLCBbc2V0R3JhcGhWaWV3XSk7CiAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ29udGFpbmVyLCBudWxsLCBmZWF0dXJlcy5lbmFibGVTbWFsbE11bHRpcGxlcyA/IFJlYWN0LmNyZWF0ZUVsZW1lbnQoVG9nZ2xlLCB7CiAgICBpbmxpbmVMYWJlbDogdHJ1ZSwKICAgIGxhYmVsOiAiQ29tbXVuaXR5IGlzb2xhdGlvbiIsCiAgICBjaGVja2VkOiBncmFwaFZpZXcgPT09IFZpZXdUeXBlLlNtYWxsTXVsdGlwbGUsCiAgICBvbkNoYW5nZTogaGFuZGxlVmlld0NoYW5nZWQKICB9KSA6IG51bGwsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQnV0dG9ucywgbnVsbCwgUmVhY3QuY3JlYXRlRWxlbWVudChEZWZhdWx0QnV0dG9uLCB7CiAgICB0ZXh0OiAnR3JpZCcsCiAgICBvbkNsaWNrOiBoYW5kbGVHcmlkQ2xpY2sKICB9KSwgZWRnZXMubnVtUm93cygpID4gMCA/IFJlYWN0LmNyZWF0ZUVsZW1lbnQoUmVhY3QuRnJhZ21lbnQsIG51bGwsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoVW1hcExheW91dCwgewogICAgb25DbGljazogaGFuZGxlVW1hcENsaWNrCiAgfSkpIDogbnVsbCksIFJlYWN0LmNyZWF0ZUVsZW1lbnQoU3RhdHVzLCBudWxsLCBsb2FkaW5nID8gUmVhY3QuY3JlYXRlRWxlbWVudChTcGlubmVyLCB7CiAgICBsYWJlbFBvc2l0aW9uOiAncmlnaHQnLAogICAgbGFiZWw6ICdDb21wdXRpbmcgbGF5b3V0Li4uJwogIH0pIDogbnVsbCkpOwp9KTsKY29uc3QgQ29udGFpbmVyID0gc3R5bGVkLmRpdmAKCW1hcmdpbjogMjBweDsKCW1hcmdpbi1ib3R0b206IDEwcHg7Cgl0ZXh0LWFsaWduOiBjZW50ZXI7CglqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKYDsKY29uc3QgQnV0dG9ucyA9IHN0eWxlZC5kaXZgCgltYXJnaW4tdG9wOiAxMHB4OwoJZGlzcGxheTogZmxleDsKCWp1c3RpZnktY29udGVudDogc3BhY2UtYXJvdW5kOwpgOwpjb25zdCBTdGF0dXMgPSBzdHlsZWQuZGl2YAoJZGlzcGxheTogZmxleDsKCWZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CglqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKCWhlaWdodDogNDJweDsKYDs="},{"version":3,"sources":["C:/ws/graph-drill/src/components/App/pages/GraphViewerPage/SidePanel/PanelComponents/Layout.tsx"],"names":["UmapLayout","DefaultButton","Spinner","Toggle","all","not","React","memo","useCallback","useState","styled","useArqueroBigTable","useArqueroEdgeTable","useSetArqueroBigTable","executeLayout","Layout","LayoutType","useFeatures","useGraphViewType","useSetGraphViewType","ViewType","nodes","edges","setBigTable","features","graphView","setGraphView","loading","setLoading","performLayout","type","console","log","finalize","table","print","merged","join","columnNames","deduped","orderby","select","dedupe","ungroup","then","handleGridClick","Grid","handleUmapClick","UMAP","handleViewChanged","e","v","SmallMultiple","SingleGraph","createElement","Container","enableSmallMultiples","inlineLabel","label","checked","onChange","Buttons","text","onClick","numRows","Fragment","Status","labelPosition","div"],"mappings":"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","sourcesContent":["/*!\r\n * Copyright (c) Microsoft. All rights reserved.\r\n * Licensed under the MIT license. See LICENSE file in the project.\r\n */\r\nimport { UmapLayout } from './UmapLayout';\r\nimport { DefaultButton, Spinner, Toggle } from '@fluentui/react';\r\nimport { all, not } from 'arquero';\r\nimport React, { memo, useCallback, useState } from 'react';\r\nimport styled from 'styled-components';\r\nimport { useArqueroBigTable, useArqueroEdgeTable, useSetArqueroBigTable, } from '~/arquero';\r\nimport { executeLayout, Layout as LayoutType } from '~/layout';\r\nimport { useFeatures, useGraphViewType, useSetGraphViewType } from '~/state';\r\nimport { ViewType } from '~/types';\r\nexport const Layout = memo(function Layout() {\r\n    const nodes = useArqueroBigTable();\r\n    const edges = useArqueroEdgeTable();\r\n    const setBigTable = useSetArqueroBigTable();\r\n    const [features] = useFeatures();\r\n    const graphView = useGraphViewType();\r\n    const setGraphView = useSetGraphViewType();\r\n    const [loading, setLoading] = useState(false);\r\n    const performLayout = useCallback((type) => {\r\n        console.log('performing layout', type);\r\n        const finalize = (table) => {\r\n            console.log('layout complete', type);\r\n            table.print();\r\n            const merged = nodes.join(table, ['node.id', 'node.id'], \r\n            // note that we're overwriting any previous columns with anything new from layout\r\n            // the full pipelines often include community.id and a size...\r\n            [not(table.columnNames()), all()]);\r\n            merged.print();\r\n            setBigTable(merged);\r\n            setLoading(false);\r\n        };\r\n        const deduped = nodes\r\n            .orderby('community.nodeCount')\r\n            .select(['node.id', 'node.x', 'node.y'])\r\n            .dedupe('node.id')\r\n            .ungroup();\r\n        executeLayout(type, deduped, edges).then(finalize);\r\n    }, [nodes, edges, setBigTable]);\r\n    const handleGridClick = useCallback(() => {\r\n        setLoading(true);\r\n        performLayout(LayoutType.Grid);\r\n    }, [performLayout]);\r\n    // const handleFA2Click = useCallback(() => {\r\n    // \tsetLoading(true)\r\n    // \tperformLayout(LayoutType.FA2)\r\n    // }, [performLayout])\r\n    const handleUmapClick = useCallback(() => {\r\n        setLoading(true);\r\n        performLayout(LayoutType.UMAP);\r\n    }, [performLayout]);\r\n    const handleViewChanged = useCallback((e, v) => setGraphView(v ? ViewType.SmallMultiple : ViewType.SingleGraph), [setGraphView]);\r\n    return (React.createElement(Container, null,\r\n        features.enableSmallMultiples ? (React.createElement(Toggle, { inlineLabel: true, label: \"Community isolation\", checked: graphView === ViewType.SmallMultiple, onChange: handleViewChanged })) : null,\r\n        React.createElement(Buttons, null,\r\n            React.createElement(DefaultButton, { text: 'Grid', onClick: handleGridClick }),\r\n            edges.numRows() > 0 ? (React.createElement(React.Fragment, null,\r\n                React.createElement(UmapLayout, { onClick: handleUmapClick }))) : null),\r\n        React.createElement(Status, null, loading ? (React.createElement(Spinner, { labelPosition: 'right', label: 'Computing layout...' })) : null)));\r\n});\r\nconst Container = styled.div `\r\n\tmargin: 20px;\r\n\tmargin-bottom: 10px;\r\n\ttext-align: center;\r\n\tjustify-content: center;\r\n`;\r\nconst Buttons = styled.div `\r\n\tmargin-top: 10px;\r\n\tdisplay: flex;\r\n\tjustify-content: space-around;\r\n`;\r\nconst Status = styled.div `\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tjustify-content: center;\r\n\theight: 42px;\r\n`;\r\n"]}]}