{"remainingRequest":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\babel-loader-virtual-fd8dd261de\\0\\cache\\babel-loader-npm-8.2.2-b4e600c2c5-df5092ef98.zip\\node_modules\\babel-loader\\lib\\index.js??ruleSet[1].rules[0].use[1]!C:\\ws\\graph-drill\\.yarn\\__virtual__\\ts-loader-virtual-aa0d54d245\\0\\cache\\ts-loader-npm-9.2.1-40e1a5908e-1f2e61905d.zip\\node_modules\\ts-loader\\index.js??ruleSet[1].rules[0].use[2]!C:\\ws\\graph-drill\\src\\components\\Export\\hooks\\useCreateRenderer.tsx","dependencies":[{"path":"C:\\ws\\graph-drill\\src\\components\\Export\\hooks\\useCreateRenderer.tsx","mtime":1631029334778},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\cache-loader-virtual-2fd14a2267\\0\\cache\\cache-loader-npm-4.1.0-82c3da90d8-0339778bdd.zip\\node_modules\\cache-loader\\dist\\cjs.js","mtime":456789000000},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\babel-loader-virtual-fd8dd261de\\0\\cache\\babel-loader-npm-8.2.2-b4e600c2c5-df5092ef98.zip\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\ws\\graph-drill\\.yarn\\__virtual__\\ts-loader-virtual-aa0d54d245\\0\\cache\\ts-loader-npm-9.2.1-40e1a5908e-1f2e61905d.zip\\node_modules\\ts-loader\\index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyohDQogKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4NCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4gU2VlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcHJvamVjdC4NCiAqLwppbXBvcnQgeyBHcmFwaFZpZXdlciB9IGZyb20gJy4uLy4uL0dyYXBoVmlld2VyJzsKaW1wb3J0IHsgVGhlbWF0aWNQcm92aWRlciwgdXNlVGhlbWF0aWMgfSBmcm9tICdAdGhlbWF0aWMvcmVhY3QnOwppbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnOwppbXBvcnQgUmVhY3RET00gZnJvbSAncmVhY3QtZG9tJzsKaW1wb3J0IHsgdXNlUmVjb2lsQnJpZGdlQWNyb3NzUmVhY3RSb290c19VTlNUQUJMRSB9IGZyb20gJ3JlY29pbCc7CmltcG9ydCB7IHVzZUR5bmFtaWNDYW1lcmFCb3VuZHMgfSBmcm9tICd+L2hvb2tzL2dyYXBoJzsKaW1wb3J0IHsgdXNlSW50ZXJuZWRHcmFwaCB9IGZyb20gJ34vc3RhdGUvY2FjaGVzJzsKLyoqDQogKiBDcmVhdGVzIGEgZGV0YWNoZWQgcmVuZGVyZXIgd2hlbiBpbnN0cnVjdGVkLCB3aGljaCB3ZSBjYW4gdXNlIHRvIGdlbmVyYXRlIGltYWdlcy4NCiAqIEBwYXJhbSBjcmVhdGUgSW5kaWNhdGVzIGlmIHRoZSByZW5kZXJlciBzaG91bGQgYmUgY3JlYXRlZC9yZWNyZWF0ZWQuDQogKiBUaGlzIGlzIGEgVUktYmxvY2tpbmcgcHJvY2Vzcywgc28gYmVzdCB0byB3YWl0IHVudGlsIHVzZXIgaGFzIHJlcXVlc3RlZCBleHBvcnQuDQogKiBAcGFyYW0gb25SZW5kZXJlciBDYWxsYmFjayB0aGF0IGZpcmVzIHdpdGggdGhlIHJlbmRlcmVyIGluc3RhbmNlIHdoZW4gcmVhZHkuDQogKi8KCmV4cG9ydCBmdW5jdGlvbiB1c2VDcmVhdGVSZW5kZXJlcihjcmVhdGUsIG9uUmVuZGVyZXJSZWFkeSkgewogIGNvbnN0IHRoZW1lID0gdXNlVGhlbWF0aWMoKTsKICBjb25zdCBkYXRhID0gdXNlSW50ZXJuZWRHcmFwaCgpOwogIGNvbnN0IGNhbWVyYUJvdW5kcyA9IHVzZUR5bmFtaWNDYW1lcmFCb3VuZHMoKTsKICBjb25zdCBSZWNvaWxCcmlkZ2UgPSB1c2VSZWNvaWxCcmlkZ2VBY3Jvc3NSZWFjdFJvb3RzX1VOU1RBQkxFKCk7CiAgdXNlRWZmZWN0KCgpID0+IHsKICAgIGNvbnN0IGRvbU5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKCiAgICBpZiAoY3JlYXRlKSB7CiAgICAgIFJlYWN0RE9NLnJlbmRlcihSZWFjdC5jcmVhdGVFbGVtZW50KFJlY29pbEJyaWRnZSwgbnVsbCwgUmVhY3QuY3JlYXRlRWxlbWVudChUaGVtYXRpY1Byb3ZpZGVyLCB7CiAgICAgICAgdGhlbWU6IHRoZW1lCiAgICAgIH0sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoR3JhcGhWaWV3ZXIsIHsKICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgIGNhbWVyYUJvdW5kczogY2FtZXJhQm91bmRzLAogICAgICAgIG9uUmVuZGVyZXJJbml0aWFsaXplZDogb25SZW5kZXJlclJlYWR5CiAgICAgIH0pKSksIGRvbU5vZGUpOwogICAgfQoKICAgIHJldHVybiAoKSA9PiB7CiAgICAgIHZhciBfZG9tTm9kZSRwYXJlbnROb2RlOwoKICAgICAgLy8gdHJhc2ggdGhlIG5vZGUgb24gdW5tb3VudCB0byBwcmV2ZW50IG1lbW9yeSBsZWFrcwogICAgICBSZWFjdERPTS51bm1vdW50Q29tcG9uZW50QXROb2RlKGRvbU5vZGUpOwogICAgICAoX2RvbU5vZGUkcGFyZW50Tm9kZSA9IGRvbU5vZGUucGFyZW50Tm9kZSkgPT09IG51bGwgfHwgX2RvbU5vZGUkcGFyZW50Tm9kZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2RvbU5vZGUkcGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkb21Ob2RlKTsKICAgIH07CiAgfSwgW2NyZWF0ZSwgdGhlbWUsIGRhdGEsIGNhbWVyYUJvdW5kcywgb25SZW5kZXJlclJlYWR5LCBSZWNvaWxCcmlkZ2VdKTsKfQ=="},{"version":3,"sources":["C:/ws/graph-drill/src/components/Export/hooks/useCreateRenderer.tsx"],"names":["GraphViewer","ThematicProvider","useThematic","React","useEffect","ReactDOM","useRecoilBridgeAcrossReactRoots_UNSTABLE","useDynamicCameraBounds","useInternedGraph","useCreateRenderer","create","onRendererReady","theme","data","cameraBounds","RecoilBridge","domNode","document","createElement","render","onRendererInitialized","unmountComponentAtNode","parentNode","removeChild"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAASA,WAAT,QAA4B,mBAA5B;AACA,SAASC,gBAAT,EAA2BC,WAA3B,QAA8C,iBAA9C;AACA,OAAOC,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,SAASC,wCAAT,QAAyD,QAAzD;AACA,SAASC,sBAAT,QAAuC,eAAvC;AACA,SAASC,gBAAT,QAAiC,gBAAjC;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,SAASC,iBAAT,CAA2BC,MAA3B,EAAmCC,eAAnC,EAAoD;AACvD,QAAMC,KAAK,GAAGV,WAAW,EAAzB;AACA,QAAMW,IAAI,GAAGL,gBAAgB,EAA7B;AACA,QAAMM,YAAY,GAAGP,sBAAsB,EAA3C;AACA,QAAMQ,YAAY,GAAGT,wCAAwC,EAA7D;AACAF,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAMY,OAAO,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAhB;;AACA,QAAIR,MAAJ,EAAY;AACRL,MAAAA,QAAQ,CAACc,MAAT,CAAgBhB,KAAK,CAACe,aAAN,CAAoBH,YAApB,EAAkC,IAAlC,EACZZ,KAAK,CAACe,aAAN,CAAoBjB,gBAApB,EAAsC;AAAEW,QAAAA,KAAK,EAAEA;AAAT,OAAtC,EACIT,KAAK,CAACe,aAAN,CAAoBlB,WAApB,EAAiC;AAAEa,QAAAA,IAAI,EAAEA,IAAR;AAAcC,QAAAA,YAAY,EAAEA,YAA5B;AAA0CM,QAAAA,qBAAqB,EAAET;AAAjE,OAAjC,CADJ,CADY,CAAhB,EAEgIK,OAFhI;AAGH;;AACD,WAAO,MAAM;AAAA;;AACT;AACAX,MAAAA,QAAQ,CAACgB,sBAAT,CAAgCL,OAAhC;AACA,6BAAAA,OAAO,CAACM,UAAR,4EAAoBC,WAApB,CAAgCP,OAAhC;AACH,KAJD;AAKH,GAZQ,EAYN,CAACN,MAAD,EAASE,KAAT,EAAgBC,IAAhB,EAAsBC,YAAtB,EAAoCH,eAApC,EAAqDI,YAArD,CAZM,CAAT;AAaH","sourcesContent":["/*!\r\n * Copyright (c) Microsoft. All rights reserved.\r\n * Licensed under the MIT license. See LICENSE file in the project.\r\n */\r\nimport { GraphViewer } from '../../GraphViewer';\r\nimport { ThematicProvider, useThematic } from '@thematic/react';\r\nimport React, { useEffect } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { useRecoilBridgeAcrossReactRoots_UNSTABLE } from 'recoil';\r\nimport { useDynamicCameraBounds } from '~/hooks/graph';\r\nimport { useInternedGraph } from '~/state/caches';\r\n/**\r\n * Creates a detached renderer when instructed, which we can use to generate images.\r\n * @param create Indicates if the renderer should be created/recreated.\r\n * This is a UI-blocking process, so best to wait until user has requested export.\r\n * @param onRenderer Callback that fires with the renderer instance when ready.\r\n */\r\nexport function useCreateRenderer(create, onRendererReady) {\r\n    const theme = useThematic();\r\n    const data = useInternedGraph();\r\n    const cameraBounds = useDynamicCameraBounds();\r\n    const RecoilBridge = useRecoilBridgeAcrossReactRoots_UNSTABLE();\r\n    useEffect(() => {\r\n        const domNode = document.createElement('div');\r\n        if (create) {\r\n            ReactDOM.render(React.createElement(RecoilBridge, null,\r\n                React.createElement(ThematicProvider, { theme: theme },\r\n                    React.createElement(GraphViewer, { data: data, cameraBounds: cameraBounds, onRendererInitialized: onRendererReady }))), domNode);\r\n        }\r\n        return () => {\r\n            // trash the node on unmount to prevent memory leaks\r\n            ReactDOM.unmountComponentAtNode(domNode);\r\n            domNode.parentNode?.removeChild(domNode);\r\n        };\r\n    }, [create, theme, data, cameraBounds, onRendererReady, RecoilBridge]);\r\n}\r\n"]}]}